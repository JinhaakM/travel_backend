$(document).ready(function() {
    var pageSize = 10; 
    var currentPage = 1;
    var $userItems = $('.user-item');
    var totalPages = Math.ceil($userItems.length / pageSize);
    
	showPage(currentPage);
	
	
	success: function(data) {
    // 서버로부터 받은 데이터를 사용하여 새 창을 엽니다.
    var newWindow = window.open('', '_blank');
    newWindow.document.write('<html><head><title>Admin Chat</title><link rel="stylesheet" href="/css/admin_chat_css.css"></head><body>');
    newWindow.document.write('<div id="container" class="container">');
    newWindow.document.write('<h1>관리자 상담</h1>');
    newWindow.document.write('<div id="chating" class="chating">' + data + '</div>');
    newWindow.document.write('<div id="yourMsg">');
    newWindow.document.write('<table class="inputTable">');
    newWindow.document.write('<tr><th>메시지</th><th><input id="chatting" placeholder="보내실 메시지를 입력하세요."></th>');
    newWindow.document.write('<th><button onclick="send()" id="sendBtn">보내기</button></th></tr></table></div></div>');
    newWindow.document.write('<script src="/js/admin_chat.js"></script></body></html>');
}
	
	
    function showPage(page) {
        var startIndex = (page - 1) * pageSize;
        var endIndex = page * pageSize;

        $userItems.hide();
        $userItems.slice(startIndex, endIndex).show();

        $('#page-info').text('유저 목록 ' + page + ' of ' + totalPages);
    }
    
    $('#prev').click(function() {
        if (currentPage > 1) {
            currentPage--;
            showPage(currentPage);
        }
    });
    
    $('#next').click(function() {
        if (currentPage < totalPages) {
            currentPage++;
            showPage(currentPage);
        }
    });
////////////////////////////////////////////////////////////////////////////  
  	$userItems.click(function() {
        var userId = $(this).data('user-id');
        $.ajax({
            url: 'admin/chat',  
            type: 'GET',
            data: { id: userId },
            success: function(data) {
                // 서버로부터 받은 데이터를 페이지에 표시합니다.
                $('#user-details').html('<h3>User Details</h3><p>' + data + '</p>');
            },
            error: function(jqXHR, textStatus, errorThrown) {
                console.error('Error fetching user details:', textStatus, errorThrown);
            }
        });
    });
});